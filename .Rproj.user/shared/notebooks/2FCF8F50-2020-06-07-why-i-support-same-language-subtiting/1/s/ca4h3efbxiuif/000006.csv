"0","# Generate dateset of deltas from 2012 to 2016"
"0","diffs <- aser %>% filter((year == 2012) | (year == 2016)) %>% group_by(State) %>%"
"0","  mutate_at(vars(starts_with(""std"")), ~.x-lag(.x, order_by = year)) %>% "
"0","  filter(year == 2016) %>% "
"0","  ungroup()"
"0",""
"0","diffs_long <- diffs %>% pivot_longer(starts_with(""std""), names_to = ""temp"", values_to = ""diff"") %>% "
"0","  mutate(class = str_sub(temp, 4,4), subject = str_extract(temp, ""(math|read)""))"
"0",""
"0",""
"0","# plot the reading changes for 2016"
"0","ggplot(diffs_long, aes(x = State, y = diff, fill=factor(ifelse(State==""maharashtra"",""Highlighted"",""Normal"")))) + "
"0","  scale_fill_manual(name = ""area"", values=c(""red"",""grey50""), guide= FALSE) +"
"0","  geom_bar(stat = ""identity"")+"
"0","  facet_grid(subject ~ class) +"
"0","  coord_flip() +"
"0","  labs(y = ""Change from 2012 to 2016"", x =element_blank(), title = ""Figure 3: Change in ASER score 2012-2016 by state, subject and grade"")"
"0",""
